<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>peerjs</title>
    <script src="https://unpkg.com/peerjs@1.4.5/dist/peerjs.min.js"></script>
</head>

<body>

    <button onclick="onconnect()">connect</button>
    <button onclick="onstart()">start</button>
    <input type="text" name="" id="peerid">
    <script type="text/javascript">
        let peer = null
        const config = null
        /*const config = {
            host: 'tnode.nbdomain.com',
            port: 443,
            secure: true,
            path: '/peerjs'
        }*/
        function onconnect() {
            const peerid = document.querySelector("#peerid").value
            peer = new Peer(null,config);
            peer.on('open',id=>{
                console.log("my id is",id)
            })
            const conn = peer.connect(peerid)
            conn.on('open', function () {
                conn.send('hi -------------------!');
                console.log("sent hi")
            });
            conn.on('error', function (err) {
                console.error(err)
            })

        }
        function onstart() {
            const peerid = document.querySelector("#peerid").value
            console.log("peerid:", peerid)
            peer = new Peer(peerid, config);
            console.log(peer)
            peer.on('open',id=>{
                console.log("my id is",id)
            })
            peer.on('connection', function (conn) {
                conn.on('data', function (data) {
                    // Will print 'hi!'
                    console.log(data);
                });
            });
        }

    </script>
</body>

</html>